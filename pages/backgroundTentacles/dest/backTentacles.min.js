function Tentacles(a,b){this.canvas=a,this.ctx=this.canvas.getContext("2d"),this.lines=[],this.timer=0+100*b,this.lastUpdate=(new Date).getTime()/1e3,this.canvas.width=$(document).width(),this.canvas.height=$(document).height(),this.randomSeed=Math.random();var c=Math.floor(255*(.7+.4*Math.random())),d=Math.floor(255*(.7+.4*Math.random())),e=Math.floor(255*(.7+0*Math.random()));this.colorA="rgb("+c+","+d+","+e+")",this.frameIndex=0;for(var f=0;200>f;f++)this.update(.03,!0)}Tentacles.prototype.update=function(a,b){this.frameIndex++;var c=(new Date).getTime()/1e3,d=a||c-this.lastUpdate;this.lastUpdate=c,this.timer+=Math.min(d,.05);var e={},f=.3*(.5+.2*this.randomSeed);e.x=Math.cos(this.timer*f+this.randomSeed)*Math.sin(.8*this.timer*f+2*this.randomSeed),e.y=Math.cos(.5*this.timer*f+this.randomSeed)*Math.sin(.7*this.timer*f),e.x=(.5+1.1*e.x)*this.canvas.width,e.y=(.5+1.1*e.y)*this.canvas.height;var g=this.getDistanceHead(e);null==g||g>70?(this.lines.length>200&&this.lines.pop(),this.lines.unshift(e)):this.lines[0]=e;for(var h=this.lines.length-1;h<this.lines.length-20;h--)console.log(this.lines[h-1],h),this.lines[h].x+=.02*this.lines[h-1].x,this.lines[h].y+=.02*this.lines[h-1].y;b||this.draw()},Tentacles.prototype.getDistanceHead=function(a){if(this.lines.length<2)return null;var b=a.x-this.lines[1].x,c=a.y-this.lines[1].y;return b*b+c*c},Tentacles.prototype.draw=function(){this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(this.lines[0].x,this.lines[0].y);for(var a=[],b=1;b<this.lines.length;b++){var c=10/this.canvas.width,d=b/this.lines.length*Math.cos(.4*this.timer+this.lines[b].y*c)*this.canvas.width*.1,e=b/this.lines.length*Math.cos(.9*this.timer+this.lines[b].x*c)*this.canvas.width*.1;this.ctx.lineTo(this.lines[b].x+d,this.lines[b].y+e),a.push(this.lines[b].x+d),a.push(this.lines[b].y+e)}var f=this.ctx.createLinearGradient(0,200,0,500);f.addColorStop(0,this.colorA),f.addColorStop(1,"#eee"),this.ctx.strokeStyle=f,this.ctx.stroke()},$(document).ready(function(){function a(){d=document.createElement("div"),document.body.appendChild(d),e=new Stats,e.domElement.style.position="absolute",e.domElement.style.top="0px",d.appendChild(e.domElement);for(var a=Math.random(),b=0;10>b;b++)f.push(new Tentacles(document.getElementById("drawCanvas"),a))}function b(){requestAnimationFrame(b),c(),e.update()}function c(){var a=document.getElementById("drawCanvas");a.width=$(document).width(),a.height=$(document).height();for(var b in f)f[b].update()}var d,e,f=(2*Math.PI,[]);a(),b()});